{% from "custom-components/sortable-table/macro.njk" import modSortableTable %}

{% set headings = [
  {
    id: "poolNumber",
    value: "Pool number",
    sort: sortOrder if sortBy === "poolNumber" else "none"
  },
  {
    id: "court",
    value: "Court name",
    sort: sortOrder if sortBy === "court" else "none"
  },
  {
    id: "dateRequested",
    value: "Date requested",
    sort: sortOrder if sortBy === "dateRequested" else "none"
  },
  {
    id: "requestedBy",
    value: "Requested by",
    sort: sortOrder if sortBy === "requestedBy" else "none"
  }
] %}

{% set rows = [] %}
{% for pool in results.data %}
  {% set row = (rows.push([
    {
      html: ('<a href="' + url('pool-overview.get', { poolNumber: pool.poolNumber }) + '" class="govuk-link">' + pool.poolNumber + "</a>") | safe
    },
    {
      text: pool.courtName | capitalizeFully
    },
    {
      text: pool.requestedDate | dateFilter("YYYY-MM-DD", "ddd D MMM yyyy")
    },
    {
      text: pool.requestedBy
    }
  ]), rows) %}
{% endfor %}

{{ modSortableTable({
  id: "coronerPoolsTable",
  caption: "Coroner court pools",
  captionClasses: "govuk-visually-hidden",
  head: headings,
  rows: rows,
  url: urlPrefix
}) }}