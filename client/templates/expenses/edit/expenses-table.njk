{% from "../../juror-management/expense-record/_partials/expenses-table-macros.njk" import consolidatedExpensesTable %}
{% from "../../juror-management/expense-record/_partials/expenses-table-macros.njk" import attendanceType %}

<table class="govuk-table mod-horizontal-scroll-table">
  <caption class="govuk-table__caption govuk-visually-hidden">Expenses list</caption>

  <hr class="govuk-section-break govuk-section-break--visible">

  <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th scope="col" class="govuk-table__header">Date</th>
      <th scope="col" class="govuk-table__header">Attendance</th>
      <th scope="col" class="govuk-table__header">Loss of earnings</th>
      <th scope="col" class="govuk-table__header">Extra care</th>
      <th scope="col" class="govuk-table__header">Other</th>
      <th scope="col" class="govuk-table__header">P. transport</th>
      <th scope="col" class="govuk-table__header">Taxi</th>
      <th scope="col" class="govuk-table__header">Motorcycle</th>
      <th scope="col" class="govuk-table__header">Car</th>
      <th scope="col" class="govuk-table__header">Bicycle</th>
      <th scope="col" class="govuk-table__header">Parking</th>
      <th scope="col" class="govuk-table__header">Food and drink</th>
      <th scope="col" class="govuk-table__header">(Smartcard)</th>
      <th scope="col" class="govuk-table__header">Method</th>
      <th scope="col" class="govuk-table__header mod-highlight-table-data__grey mod-center-table-data">Total</th>
    </tr>
  </thead>
  <tbody class="govuk-table__body">

    {% for expense in expensesData.expenseDetails %}

      {% set originalExpense = originalExpenses[expense.attendanceDate] %}

      <tr class="govuk-table__row {% if originalExpense %}mod-highlight-table-row__light-blue{% endif %}">
        <td class="govuk-table__cell jd-middle-align">
          <a class="govuk-link govuk-link--no-visited-state" href="{{ url('juror-management.edit-expense.edit.get', {
            jurorNumber: jurorNumber,
            locCode: locCode,
            status: status
          }) }}?date={{ expense.attendanceDate }}&page={{ loop.index }}">
            {{ expense.attendanceDate | dateFilter("YYYY-MM-DD", "ddd DD MMM YYYY") }}
          </a>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            {{ attendanceType({ attendance: originalExpense.attendanceType }) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.attendanceType !== expense.attendanceType %}mod-bold{% endif %}">
            {{ attendanceType({ attendance: expense.attendanceType }) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.lossOfEarnings | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.lossOfEarnings !== expense.lossOfEarnings %}mod-bold{% endif %}">
            £{{ expense.lossOfEarnings | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.extraCare | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.extraCare !== expense.extraCare %}mod-bold{% endif %}">
            £{{ expense.extraCare | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.other | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.other !== expense.other %}mod-bold{% endif %}">
            £{{ expense.other | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.publicTransport | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.publicTransport !== expense.publicTransport %}mod-bold{% endif %}">
            £{{ expense.publicTransport | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.taxi | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.taxi !== expense.taxi %}mod-bold{% endif %}">
            £{{ expense.taxi | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.motorcycle | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.motorcycle !== expense.motorcycle %}mod-bold{% endif %}">
            £{{ expense.motorcycle | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.car | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.car !== expense.car %}mod-bold{% endif %}">
            £{{ expense.car | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.bicycle | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.bicycle !== expense.bicycle %}mod-bold{% endif %}">
            £{{ expense.bicycle | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpenses[expense.attendanceDate].parking | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.parking !== expense.parking %}mod-bold{% endif %}">
            £{{ expense.parking | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            £{{ originalExpense.foodAndDrink | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.foodAndDrink !== expense.foodAndDrink %}mod-bold{% endif %}">
            £{{ expense.foodAndDrink | toFixed(2) }}
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            (£{{ originalExpense.smartCard | toFixed(2) }})
          {% endif %}
          <div class="{% if originalExpense and originalExpense.smartCard !== expense.smartCard %}mod-bold{% endif %}">
            (£{{ expense.smartCard | toFixed(2) }})
          </div>
        </td>
        <td class="govuk-table__cell">
          {% if originalExpense %}
            {{ originalExpense.paymentMethod }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.paymentMethod !== expense.paymentMethod %}mod-bold{% endif %}">
            {{ expense.paymentMethod }}
          </div>
        </td>
        <td class="govuk-table__cell mod-highlight-table-data__grey mod-center-table-data">
          {% if originalExpense %}
            £{{ originalExpense.total | toFixed(2) }}
          {% endif %}
          <div class="{% if originalExpense and originalExpense.total !== expense.total %}mod-bold{% endif %}">
            £{{ expense.total | toFixed(2) }}
          </div>
        </td>
      </tr>
    {% endfor %}

    <tr class="govuk-table__row mod-highlight-table-row__grey">
      <td class="govuk-table__cell">
        <b>Totals</b>
      </td>
      <td class="govuk-table__cell">
        <b>{{ total.totalDays }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.lossOfEarnings | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.extraCare | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.other | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.publicTransport | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.taxi | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.motorcycle | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.car | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.bicycle | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.parking | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>£{{ total.foodAndDrink | toFixed(2) }}</b>
      </td>
      <td class="govuk-table__cell">
        <b>(£{{ total.smartCard | toFixed(2) }})</b>
      </td>
      <td class="govuk-table__cell"></td>
      <td class="govuk-table__cell mod-center-table-data">
        <b>£{{ total.total | toFixed(2) }}</b>
      </td>
    </tr>

  </tbody>
</table>