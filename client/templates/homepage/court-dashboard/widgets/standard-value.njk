{% from "moj/components/badge/macro.njk" import mojBadge %}

{% set dataHeadingType = "h4" if widget.templateOptions.title else "h3" %}

{% if widget.templateOptions.title %}
  <div id="widget_{{ widgetId }}" class="govuk-grid-row" aria-label="{{ widget.templateOptions.title }} widget">
    <div class="govuk-grid-column-full">
      <h3 class="govuk-heading-s mod-dashboard__subtitle govuk-!-margin-bottom-0" aria-label="{{ widget.templateOptions.title }}"> {{ widget.templateOptions.title }} </h3>
    </div>
  </div>
{% endif %}
{% for data in widget.values %}

  {% set value = "-" %}
  {% if data.value is not none %}
    {% set value = data.value %}
  {% endif %}

  <div class="govuk-grid-row govuk-!-margin-top-4" aria-label="{{ data.heading | default('Value') }} row">
    <div class="govuk-grid-column-full">
      <{{ dataHeadingType }} class="govuk-heading-s govuk-!-margin-bottom-1" aria-label="{{ data.heading }}">{{ data.heading }}</{{ dataHeadingType }}>
      <p class="govuk-body govuk-!-margin-bottom-1" aria-label="{{ value if value != '-' else 'No data available' }}">{{ value }}</p>
      {% if data.badge and data.badge.showBadge %}
        {{ mojBadge({
          text: data.badge.text,
          classes: "moj-badge--" + (data.badge.colour or "blue") + " govuk-!-margin-bottom-1",
          attributes: { "aria-label": data.badge.text }
        }) }}
      {% endif %}
      {% for link in data.links %}
        <p class=" govuk-body govuk-!-margin-bottom-1"><a href="{{ link.href }}" class="govuk-link govuk-link--no-visited-state" aria-label="{{ link.text }}">{{ link.text }}</a></p>
      {% endfor %}
    </div>
  </div>
{% endfor %}