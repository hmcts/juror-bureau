<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1111px" preserveAspectRatio="none" style="width:1977px;height:1111px;background:#FFFFFF;" version="1.1" viewBox="0 0 1977 1111" width="1977px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="1961.5" x="10" y="363.082"/><rect fill="none" height="105.2422" style="stroke:#000000;stroke-width:1.5;" width="1810.5" x="10" y="628.877"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="1961.5" x="10" y="953.293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="45" x2="45" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="256.5" x2="256.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="383.5" x2="383.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="520.5" x2="520.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="747.5" x2="747.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="973.5" x2="973.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1140.5" x2="1140.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1308.5" x2="1308.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1533.5" x2="1533.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1746.5" x2="1746.5" y1="52.9766" y2="1104.8457"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1890.5" x2="1890.5" y1="52.9766" y2="1104.8457"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51" x="20" y="21.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="27" y="42.0234">Actor</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="188.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="74" x="219.5" y="25.5352">«/process»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="195.5" y="42.0234">ProcessReplyPage</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="334.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="73" x="347.5" y="25.5352">«/excusal»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="341.5" y="42.0234">ExcusalPage</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="155" x="443.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="61" x="490.5" y="25.5352">«/inbox»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="450.5" y="42.0234">SummonsInboxPage</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="279" x="608.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="265" x="615.5" y="25.5352">«summons-management.controller.js»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="227" x="634.5" y="42.0234">SummonsManagementController</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="897.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="102" x="923" y="25.5352">«excusal.get()»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="904.5" y="42.0234">ExcusalCodesObject</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="1060.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="147" x="1067.5" y="25.5352">«excusalObject.put()»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1093" y="42.0234">ExcusalObject</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154" x="1231.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="140" x="1238.5" y="25.5352">«inbox.controller.js»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="1253.5" y="42.0234">InboxController</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="277" x="1395.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="263" x="1402.5" y="25.5352">«summons-management/excusal.njk»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="1476" y="42.0234">ExcusalTemplate</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="1682.5" y="21.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="1689.5" y="42.0234">ExcusalValidator</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="1820.5" y="21.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="1827.5" y="42.0234">BackendController</text><polygon fill="#181818" points="244.5,80.2871,254.5,84.2871,244.5,88.2871" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="45.5" x2="250.5" y1="84.2871" y2="84.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="78.5" y="79.5449">grant or refuse excusal</text><polygon fill="#181818" points="736,109.5977,746,113.5977,736,117.5977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256.5" x2="742" y1="113.5977" y2="113.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="441.75" y="108.8555">call page controller</text><polygon fill="#181818" points="962,138.9082,972,142.9082,962,146.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="748" x2="968" y1="142.9082" y2="142.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="798" y="138.166">build request object</text><polygon fill="#181818" points="1879,168.2188,1889,172.2188,1879,176.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="974" x2="1885" y1="172.2188" y2="172.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="1363.5" y="167.4766">send backend request</text><polygon fill="#181818" points="985,197.5293,975,201.5293,985,205.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="979" x2="1890" y1="201.5293" y2="201.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1394" y="196.7871">ok response</text><polygon fill="#181818" points="759,226.8398,749,230.8398,759,234.8398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="753" x2="973" y1="230.8398" y2="230.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="813" y="226.0977">resolve request</text><polygon fill="#181818" points="1522,256.1504,1532,260.1504,1522,264.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="748" x2="1528" y1="260.1504" y2="260.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1056.5" y="255.4082">request and build template</text><polygon fill="#181818" points="759,285.4609,749,289.4609,759,293.4609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="753" x2="1533" y1="289.4609" y2="289.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1102" y="284.7188">return HTML</text><polygon fill="#181818" points="395,314.7715,385,318.7715,395,322.7715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="389" x2="747" y1="318.7715" y2="318.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="527" y="314.0293">return HTML</text><polygon fill="#181818" points="56.5,344.082,46.5,348.082,56.5,352.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="50.5" x2="383" y1="348.082" y2="348.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="174.75" y="343.3398">render HTML</text><path d="M10,363.082 L72,363.082 L72,370.3926 L62,380.3926 L10,380.3926 L10,363.082 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="1961.5" x="10" y="363.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="376.6504">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="184" x="87" y="375.7168">[Failed to retrieve excusal codes]</text><polygon fill="#181818" points="985,397.7031,975,401.7031,985,405.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="979" x2="1890" y1="401.7031" y2="401.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="1387" y="396.9609">error response</text><polygon fill="#181818" points="759,427.0137,749,431.0137,759,435.0137" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="753" x2="973" y1="431.0137" y2="431.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="797.5" y="426.2715">reject requestObject</text><polygon fill="#181818" points="267.5,456.3242,257.5,460.3242,267.5,464.3242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261.5" x2="747" y1="460.3242" y2="460.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="408.75" y="455.582">redirect to process reply page</text><polygon fill="#181818" points="56.5,485.6348,46.5,489.6348,56.5,493.6348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50.5" x2="255.5" y1="489.6348" y2="489.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="57.5" y="484.8926">redirect to process reply page</text><polygon fill="#181818" points="372,521.9453,382,525.9453,372,529.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="45.5" x2="378" y1="525.9453" y2="525.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="107.75" y="521.2031">enter excusal reason and decision</text><polygon fill="#181818" points="736,551.2559,746,555.2559,736,559.2559" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="384" x2="742" y1="555.2559" y2="555.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="505.5" y="550.5137">call page controller</text><polygon fill="#181818" points="1734.5,580.5664,1744.5,584.5664,1734.5,588.5664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="748" x2="1740.5" y1="584.5664" y2="584.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="1157.75" y="579.8242">validate reason and decision</text><polygon fill="#181818" points="759,609.877,749,613.877,759,617.877" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="753" x2="1745.5" y1="613.877" y2="613.877"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="1155.75" y="609.1348">reason and decision are valid</text><path d="M10,628.877 L72,628.877 L72,636.1875 L62,646.1875 L10,646.1875 L10,628.877 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="105.2422" style="stroke:#000000;stroke-width:1.5;" width="1810.5" x="10" y="628.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="642.4453">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="280" x="87" y="641.5117">[Excusal reason or decision is invalid or missing]</text><polygon fill="#181818" points="759,663.498,749,667.498,759,671.498" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="753" x2="1745.5" y1="667.498" y2="667.498"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="1123.25" y="662.7559">reason or decision is invalid or missing</text><polygon fill="#181818" points="395,692.8086,385,696.8086,395,700.8086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="747" y1="696.8086" y2="696.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="520.5" y="692.0664">error response</text><polygon fill="#181818" points="56.5,722.1191,46.5,726.1191,56.5,730.1191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50.5" x2="383" y1="726.1191" y2="726.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="148.25" y="721.377">render error message</text><polygon fill="#181818" points="1129,758.4297,1139,762.4297,1129,766.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="748" x2="1135" y1="762.4297" y2="762.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="881.5" y="757.6875">build request object</text><polygon fill="#181818" points="1879,787.7402,1889,791.7402,1879,795.7402" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1141" x2="1885" y1="791.7402" y2="791.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="1447" y="786.998">send backend request</text><polygon fill="#181818" points="1152,817.0508,1142,821.0508,1152,825.0508" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1146" x2="1890" y1="821.0508" y2="821.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1477.5" y="816.3086">ok response</text><polygon fill="#181818" points="759,846.3613,749,850.3613,759,854.3613" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="753" x2="1140" y1="850.3613" y2="850.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="896.5" y="845.6191">resolve request</text><polygon fill="#181818" points="1296.5,875.6719,1306.5,879.6719,1296.5,883.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="748" x2="1302.5" y1="879.6719" y2="879.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="975.75" y="874.9297">redirect to inbox</text><polygon fill="#181818" points="532,904.9824,522,908.9824,532,912.9824" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="526" x2="1307.5" y1="908.9824" y2="908.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="862.25" y="904.2402">redirect to inbox</text><polygon fill="#181818" points="56.5,934.293,46.5,938.293,56.5,942.293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="50.5" x2="520" y1="938.293" y2="938.293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="230.75" y="933.5508">redirect to inbox</text><path d="M10,953.293 L72,953.293 L72,960.6035 L62,970.6035 L10,970.6035 L10,953.293 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="1961.5" x="10" y="953.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="966.8613">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="148" x="87" y="965.9277">[Failed to process excusal]</text><polygon fill="#181818" points="1152,987.9141,1142,991.9141,1152,995.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1146" x2="1890" y1="991.9141" y2="991.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="1470.5" y="987.1719">error response</text><polygon fill="#181818" points="759,1017.2246,749,1021.2246,759,1025.2246" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="753" x2="1140" y1="1021.2246" y2="1021.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="886.5" y="1016.4824">reject requestBody</text><polygon fill="#181818" points="395,1046.5352,385,1050.5352,395,1054.5352" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="747" y1="1050.5352" y2="1050.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="520.5" y="1045.793">error response</text><polygon fill="#181818" points="56.5,1075.8457,46.5,1079.8457,56.5,1083.8457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="50.5" x2="383" y1="1079.8457" y2="1079.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="148.25" y="1075.1035">render error message</text><!--MD5=[917d4dd1c663ee2019b1a231e80237f3]
@startuml excusal-mod

skinparam Style strictuml 
skinparam SequenceMessageAlignment center

participant Actor

''' LOCAL ROUTING
participant ProcessReplyPage <</process>>
participant ExcusalPage <</excusal>>
participant SummonsInboxPage <</inbox>>


''' CONTROLLER AND REQUEST OBJECTS
participant SummonsManagementController <<summons-management.controller.js>>
participant ExcusalCodesObject <<excusal.get()>>
participant ExcusalObject <<excusalObject.put()>>
participant InboxController <<inbox.controller.js>>

''' TEMPLATES
participant ExcusalTemplate <<summons-management/excusal.njk>>

''' FILTERS AND VALIDATORS
participant ExcusalValidator

''' BACKEND CONTROLLER
participant BackendController



''' JOURNEY FLOW
Actor -> ProcessReplyPage : grant or refuse excusal

ProcessReplyPage -> SummonsManagementController : call page controller

SummonsManagementController -> ExcusalCodesObject : build request object
ExcusalCodesObject -> BackendController : send backend request
ExcusalCodesObject <- BackendController : ok response
SummonsManagementController <- ExcusalCodesObject : resolve request

SummonsManagementController -> ExcusalTemplate : request and build template
SummonsManagementController <- ExcusalTemplate : return HTML
ExcusalPage <- SummonsManagementController : return HTML
Actor <- ExcusalPage : render HTML

alt Failed to retrieve excusal codes
    ExcusalCodesObject <- - BackendController : error response
    SummonsManagementController <- - ExcusalCodesObject : reject requestObject
    ProcessReplyPage <- - SummonsManagementController : redirect to process reply page
    Actor <- - ProcessReplyPage : redirect to process reply page
end

Actor -> ExcusalPage : enter excusal reason and decision

ExcusalPage -> SummonsManagementController : call page controller

SummonsManagementController -> ExcusalValidator : validate reason and decision
SummonsManagementController <- ExcusalValidator : reason and decision are valid

alt Excusal reason or decision is invalid or missing
    SummonsManagementController <- - ExcusalValidator : reason or decision is invalid or missing
    ExcusalPage <- - SummonsManagementController : error response
    Actor <- - ExcusalPage : render error message
end

SummonsManagementController -> ExcusalObject : build request object
ExcusalObject -> BackendController : send backend request
ExcusalObject <- BackendController : ok response
SummonsManagementController <- ExcusalObject : resolve request

SummonsManagementController -> InboxController : redirect to inbox
SummonsInboxPage <- InboxController : redirect to inbox
Actor <- SummonsInboxPage : redirect to inbox

alt Failed to process excusal
    ExcusalObject <- - BackendController : error response
    SummonsManagementController <- - ExcusalObject : reject requestBody
    ExcusalPage <- - SummonsManagementController : error response
    Actor <- - ExcusalPage : render error message
end

@enduml

@startuml excusal-mod

skinparam Style strictuml 
skinparam SequenceMessageAlignment center

participant Actor

participant ProcessReplyPage <</process>>
participant ExcusalPage <</excusal>>
participant SummonsInboxPage <</inbox>>


participant SummonsManagementController <<summons-management.controller.js>>
participant ExcusalCodesObject <<excusal.get()>>
participant ExcusalObject <<excusalObject.put()>>
participant InboxController <<inbox.controller.js>>

participant ExcusalTemplate <<summons-management/excusal.njk>>

participant ExcusalValidator

participant BackendController



Actor -> ProcessReplyPage : grant or refuse excusal

ProcessReplyPage -> SummonsManagementController : call page controller

SummonsManagementController -> ExcusalCodesObject : build request object
ExcusalCodesObject -> BackendController : send backend request
ExcusalCodesObject <- BackendController : ok response
SummonsManagementController <- ExcusalCodesObject : resolve request

SummonsManagementController -> ExcusalTemplate : request and build template
SummonsManagementController <- ExcusalTemplate : return HTML
ExcusalPage <- SummonsManagementController : return HTML
Actor <- ExcusalPage : render HTML

alt Failed to retrieve excusal codes
    ExcusalCodesObject <- - BackendController : error response
    SummonsManagementController <- - ExcusalCodesObject : reject requestObject
    ProcessReplyPage <- - SummonsManagementController : redirect to process reply page
    Actor <- - ProcessReplyPage : redirect to process reply page
end

Actor -> ExcusalPage : enter excusal reason and decision

ExcusalPage -> SummonsManagementController : call page controller

SummonsManagementController -> ExcusalValidator : validate reason and decision
SummonsManagementController <- ExcusalValidator : reason and decision are valid

alt Excusal reason or decision is invalid or missing
    SummonsManagementController <- - ExcusalValidator : reason or decision is invalid or missing
    ExcusalPage <- - SummonsManagementController : error response
    Actor <- - ExcusalPage : render error message
end

SummonsManagementController -> ExcusalObject : build request object
ExcusalObject -> BackendController : send backend request
ExcusalObject <- BackendController : ok response
SummonsManagementController <- ExcusalObject : resolve request

SummonsManagementController -> InboxController : redirect to inbox
SummonsInboxPage <- InboxController : redirect to inbox
Actor <- SummonsInboxPage : redirect to inbox

alt Failed to process excusal
    ExcusalObject <- - BackendController : error response
    SummonsManagementController <- - ExcusalObject : reject requestBody
    ExcusalPage <- - SummonsManagementController : error response
    Actor <- - ExcusalPage : render error message
end

@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 BST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>